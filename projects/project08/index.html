<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0048)http://www1.idc.ac.il/tecs/projects/08/index.htm -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1255">

<meta content="Microsoft FrontPage 4.0" name="GENERATOR">
<!--<base target="_self">--><base href="." target="_self">
</head>
<body>
<font color="#004080"><i>The Elements of Computing&nbsp; Systems </i>/ <i>Nisan
&amp; Schocken</i></font><span style="color:#004080;
mso-fareast-language:EN-US"><i> </i>/ www.idc.ac.il/tecs</span><font color="#004080"><i>&nbsp;
</i> </font><font color="#004080" face="Arial"><strong><br>
<br>
<font size="5">Project 8: </font></strong><font size="5"><strong>The VM: Program
Control</strong></font></font>
<p class="MsoBodyText" style="text-align:justify"><span style="font-size:12.0pt;mso-fareast-language:EN-US;layout-grid-mode:line"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;;
mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-US;mso-fareast-language:
EN-US;mso-bidi-language:HE;layout-grid-mode:line"><b>Objective:</b>  Extend the
basic VM translator built in Project 7 into a full-scale VM translator. In
particular, add the ability to handle the <i>program flow</i> and <i>function
calling </i>commands
of the VM language.</span></span></p>
<p class="MsoBodyText" style="text-align:justify"><span style="font-size:12.0pt;mso-fareast-language:EN-US;layout-grid-mode:
line"><span><b>Resources</b>  </span><span style="font-size:12.0pt;mso-fareast-language:EN-US;layout-grid-mode:line">(same
as Project 7): You
will need two tools: the programming language in which you will implement your
VM Translator, and the <i> CPU Emulator</i> supplied with the book. This emulator
allows executing the machine code generated by your VM Translator -- an
indirect way to test the correctness of the latter. Another tool that may come
handy in this project is the visual <i>VM Emulator</i> supplied with the book.
This program allows experimenting with a working VM implementation before you
set out to build one yourself. For more information about this tool, refer to
the <i>VM Emulator Tutorial</i>.<o:p>
</o:p>
</span>
</span></p>

<p class="MsoBodyText" style="text-align:justify"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;;
mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-US;mso-fareast-language:
EN-US;mso-bidi-language:HE;layout-grid-mode:line"><b>Contract:</b> Write a full-scale VM-to-Hack
 translator, extending the translator developed in Project 7, and conforming to
the <i>VM Specification, Part II </i>(Section 8.2) and the to the <i>Standard
VM-on-Hack Mapping, Part II</i>  (Section 8.3.1).</span><span style="font-size: 12.0pt; mso-fareast-language: EN-US; layout-grid-mode: line"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;;
mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-US;mso-fareast-language:
EN-US;mso-bidi-language:HE;layout-grid-mode:line"> Use it to translate the </span><span style="font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:&quot;Courier New&quot;;mso-fareast-font-family:
&quot;Times New Roman&quot;;mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:
EN-US;mso-fareast-language:HE;mso-bidi-language:HE" class="code">.vm</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;;mso-fareast-font-family:
&quot;Times New Roman&quot;;mso-ansi-language:EN-US;mso-fareast-language:EN-US;
mso-bidi-language:HE;layout-grid-mode:line"> programs supplied below, yielding
corresponding </span><span style="font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:&quot;Courier New&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-US;mso-fareast-language:
HE;mso-bidi-language:HE" class="code">.asm</span><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-ansi-language:EN-US;mso-fareast-language:EN-US;mso-bidi-language:HE;
layout-grid-mode:line"> programs written in the Hack assembly language. When
executed on the supplied CPU emulator, these </span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;;mso-fareast-font-family:
&quot;Times New Roman&quot;;mso-ansi-language:EN-US;mso-fareast-language:HE;mso-bidi-language:
HE" class="code">assembly </span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;;
mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-US;mso-fareast-language:
EN-US;mso-bidi-language:HE;layout-grid-mode:line">programs should deliver the results mandated by the supplied test scripts and
compare files.</span></span></p>

<p class="MsoBodyText" style="text-align:justify;mso-outline-level:1"><font color="#004080" face="Arial" size="3"><strong>Test
Programs</strong></font>
</p>
<p class="MsoBodyText" style="text-align:justify">We recommend completing the implementation
of the translator in two stages. First i<span style="mso-fareast-language:EN-US">mplement
the <i>program flow </i>commands, and then the <i>function calling</i> commands.
</span>This will allow you to unit-test your implementation incrementally, using
the test programs supplied below.</p>

<p class="MsoBodyText" style="text-align:justify"><span style="font-size:12.0pt">For
each program </span><span style="font-size: 10.0pt; mso-bidi-font-size: 12.0pt; font-family: Courier New; mso-bidi-font-family: Times New Roman" class="code">Xxx</span><span style="font-size:12.0pt">,
the<span style="mso-spacerun:
yes">&nbsp; </span></span><span style="font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:&quot;Courier New&quot;;mso-bidi-font-family:&quot;Times New Roman&quot;" class="code">XxxVME.tst</span><span style="font-size:12.0pt">
script allows running the program on the supplied VM Emulator, so that you can gain
familiarity with the program�s intended operation. After translating the
program using your VM Translator, the supplied </span><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:
&quot;Courier New&quot;;mso-bidi-font-family:&quot;Times New Roman&quot;" class="code">Xxx.tst</span><span style="font-size:12.0pt">
and </span><span style="font-size:
10.0pt;mso-bidi-font-size:12.0pt;font-family:&quot;Courier New&quot;;mso-bidi-font-family:
&quot;Times New Roman&quot;" class="code">Xxx.cmp</span><span style="font-size:12.0pt">
scripts allow testing the translated assembly code on the CPU Emulator.<o:p>
</o:p>
</span></p>

<p class="MsoBodyText" style="text-align:justify"><span style="font-size: 12.0pt"><b>Testing
the program
flow commands implementation:</b></span></p>

<table border="1" width="713" cellspacing="4" cellpadding="4" bordercolor="#EFCA85">
  <tbody><tr>
    <td width="132" valign="top" align="left" height="10" bgcolor="#F1DCA9"><font face="Times New Roman" color="#00007D" size="2"><b>Program</b></font></td>
    <td width="560" valign="top" align="left" height="10" bgcolor="#F1DCA9"><font face="Times New Roman" color="#00007D" size="2"><b>Description</b></font></td>
    <td width="191" valign="top" align="left" height="10" bgcolor="#F1DCA9"><font face="Times New Roman" color="#00007D" size="2"><b>Test
      script</b></font></td>
  </tr>
  <tr>
    <td width="132" valign="top" align="left" height="36">
    <p style="line-height: 100%; margin-top: 8; margin-bottom: 0"><a href="http://www1.idc.ac.il/tecs/projects/08/ProgramFlow/BasicLoop/BasicLoop.vm" target="_self"><font face="Courier New" size="2">BasicLoop.vm</font></a>
    </p></td>
    <td width="560" valign="top" align="left" height="36">
    <p style="line-height: 100%; margin-top: 2; margin-bottom: 0"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;;mso-fareast-font-family:
&quot;Times New Roman&quot;;mso-ansi-language:EN-US;mso-fareast-language:HE;mso-bidi-language:
HE;layout-grid-mode:line">  Computes the sum <span style="mso-text-raise:
-3.0pt"><!--[if gte vml 1]><v:shapetype id="_x0000_t75" coordsize="21600,21600"
 o:spt="75" o:preferrelative="t" path="m@4@5l@4@11@9@11@9@5xe" filled="f"
 stroked="f">
 <v:stroke joinstyle="miter"/>
 <v:formulas>
  <v:f eqn="if lineDrawn pixelLineWidth 0"/>
  <v:f eqn="sum @0 1 0"/>
  <v:f eqn="sum 0 0 @1"/>
  <v:f eqn="prod @2 1 2"/>
  <v:f eqn="prod @3 21600 pixelWidth"/>
  <v:f eqn="prod @3 21600 pixelHeight"/>
  <v:f eqn="sum @0 0 1"/>
  <v:f eqn="prod @6 1 2"/>
  <v:f eqn="prod @7 21600 pixelWidth"/>
  <v:f eqn="sum @8 21600 0"/>
  <v:f eqn="prod @7 21600 pixelHeight"/>
  <v:f eqn="sum @10 21600 0"/>
 </v:formulas>
 <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>
 <o:lock v:ext="edit" aspectratio="t"/>
</v:shapetype><v:shape id="_x0000_i1025" type="#_x0000_t75" style='width:63.75pt;
 height:14.25pt' o:ole="">
 <v:imagedata src="file:///C:/DOCUME~1/shimon/LOCALS~1/Temp/msoclip1/01/clip_image001.wmz"
  o:title=""/>
</v:shape><![endif]-->
    1+2+...+<i>n</i> </span><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Equation.3" ShapeID="_x0000_i1025"
  DrawAspect="Content" ObjectID="_1110697534">
 </o:OLEObject>
</xml><![endif]-->
    and pushes the result onto the stack</span><span style="font-size: 12.0pt; font-family: Times New Roman; mso-fareast-font-family: Times New Roman; mso-ansi-language: EN-US; mso-fareast-language: HE; mso-bidi-language: HE" class="code">.
    This program </span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;;
mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-US;mso-fareast-language:
HE;mso-bidi-language:HE;layout-grid-mode:line"> tests </span><span style="font-size: 12.0pt; font-family: Times New Roman; mso-fareast-font-family: Times New Roman; mso-ansi-language: EN-US; mso-fareast-language: HE; mso-bidi-language: HE; layout-grid-mode: line">the
    implementation of the VM language's </span><span style="font-size: 10.0pt; font-family: Courier New; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: Times New Roman" class="code">goto</span><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-ansi-language:EN-US;mso-fareast-language:HE;mso-bidi-language:HE;
layout-grid-mode:line">  and </span><span style="font-size: 10.0pt; font-family: Courier New; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: Times New Roman" class="code">if-goto</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;;mso-fareast-font-family:
&quot;Times New Roman&quot;;mso-ansi-language:EN-US;mso-fareast-language:HE;mso-bidi-language:
HE;layout-grid-mode:line">   commands.&nbsp;</span>
    </p></td>
    <td width="191" valign="top" align="left" height="36">
    <p style="line-height: 100%; margin-top: 0; margin-bottom: 0"><font face="Courier New" size="2"><a href="http://www1.idc.ac.il/tecs/projects/08/ProgramFlow/BasicLoop/BasicLoopVME.tst" target="_self">BasicLoopVME.tst</a></font></p><p style="line-height: 100%; margin-top: 0; margin-bottom: 0"><a href="http://www1.idc.ac.il/tecs/projects/08/ProgramFlow/BasicLoop/BasicLoop.tst" target="_self"><font face="Courier New" size="2">BasicLoop.tst</font></a></p><p style="line-height: 100%; margin-top: 0; margin-bottom: 0"><font face="Courier New" size="2"><a href="http://www1.idc.ac.il/tecs/projects/08/ProgramFlow/BasicLoop/BasicLoop.cmp" target="_self">BasicLoop.cmp</a>&nbsp;</font>
    </p></td>
  </tr>
  <tr>
    <td width="132" valign="top" align="left" height="36">
    <p style="line-height: 100%; margin-top: 8; margin-bottom: 0"><a href="http://www1.idc.ac.il/tecs/projects/08/ProgramFlow/FibonacciSeries/FibonacciSeries.vm" target="_self"><font face="Courier New" size="2">FibonacciSeries.vm</font></a>
    </p></td>
    <td width="560" valign="top" align="left" height="36">
    <p style="line-height: 100%; margin-top: 2; margin-bottom: 0"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;;
mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-US;mso-fareast-language:
HE;mso-bidi-language:HE;layout-grid-mode:line"> Computes
    and stores in memory the first <i>n</i> elements of the Fibonacci
    series.&nbsp; This typical array manipulation program provides a more
    challenging test of the VM's branching commands. </span><span style="font-size:12.0pt;mso-fareast-language:EN-US;layout-grid-mode:line">
    </span>
    </p></td>
    <td width="191" valign="top" align="left" height="36">
    <p style="line-height: 100%; margin-top: 0; margin-bottom: 0"><font face="Courier New" size="2"><a href="http://www1.idc.ac.il/tecs/projects/08/ProgramFlow/FibonacciSeries/FibonacciSeriesVME.tst" target="_self">FibonacciSeriesVME.tst</a></font></p><p style="line-height: 100%; margin-top: 0; margin-bottom: 0"><font face="Courier New" size="2"><a href="http://www1.idc.ac.il/tecs/projects/08/ProgramFlow/FibonacciSeries/FibonacciSeries_vm.tst" target="_self">FibonacciSeries</a></font><a href="http://www1.idc.ac.il/tecs/projects/08/ProgramFlow/FibonacciSeries/FibonacciSeries.tst" target="_self"><font face="Courier New" size="2">.tst</font></a></p><p style="line-height: 100%; margin-top: 0; margin-bottom: 0"><font face="Courier New" size="2"><a href="http://www1.idc.ac.il/tecs/projects/08/ProgramFlow/FibonacciSeries/FibonacciSeries.cmp" target="_self">FibonacciSeries.cmp</a></font><a href="http://www1.idc.ac.il/tecs/projects/08/ProgramFlow/FibonacciSeries/FibonacciSeries.cmp" target="_self"><span style="font-size:12.0pt;mso-fareast-language:EN-US;layout-grid-mode:line"></span>
    </a>
    </p></td>
  </tr>
</tbody></table>

<p class="MsoBodyText" style="text-align:justify"><span style="font-size: 12.0pt"><b>Testing
the function calling commands implementation:</b></span></p>

<table border="1" width="707" cellspacing="4" cellpadding="4" bordercolor="#EFCA85">
  <tbody><tr>
    <td width="99" valign="top" align="left" height="10" bgcolor="#F1DCA9"><font face="Times New Roman" color="#00007D" size="2"><b>Program</b></font></td>
    <td width="643" valign="top" align="left" height="10" bgcolor="#F1DCA9"><font face="Times New Roman" color="#00007D" size="2"><b>Description</b></font></td>
    <td width="192" valign="top" align="left" height="10" bgcolor="#F1DCA9"><font face="Times New Roman" color="#00007D" size="2"><b>Test
      script</b></font></td>
  </tr>
  <tr>
    <td width="99" valign="top" align="left" height="36">
    <p style="line-height: 100%; margin-top: 8; margin-bottom: 0"><a href="http://www1.idc.ac.il/tecs/projects/08/FunctionCalls/SimpleFunction/SimpleFunction.vm" target="_self"><font face="Courier New" size="2">SimpleFunction.vm</font></a>
    </p></td>
    <td width="643" valign="top" align="left" height="36">
    <p style="line-height: 100%; margin-top: 2; margin-bottom: 0"><span style="font-size:12.0pt;mso-fareast-language:EN-US;layout-grid-mode:line">Performs a simple calculation and returns the
    result. This program provides a basic test of the implementation of the </span><span style="font-size: 10.0pt; mso-bidi-font-size: 12.0pt; font-family: Courier New; mso-bidi-font-family: Times New Roman" class="code">function</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;;
mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-US;mso-fareast-language:
HE;mso-bidi-language:HE"><span style="font-size:12.0pt;mso-fareast-language:EN-US;layout-grid-mode:line">
    and
    </span>
    </span><span style="font-size: 10.0pt; mso-bidi-font-size: 12.0pt; font-family: Courier New; mso-bidi-font-family: Times New Roman" class="code">return</span><span style="font-size:12.0pt;mso-fareast-language:EN-US;layout-grid-mode:line"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;;
mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-US;mso-fareast-language:
HE;mso-bidi-language:HE">
    commands.</span></span>
    </p></td>
    <td width="192" valign="top" align="left" height="36">
    <p style="line-height: 100%; margin-top: 0; margin-bottom: 0"><font face="Courier New" size="2"><a href="http://www1.idc.ac.il/tecs/projects/08/FunctionCalls/SimpleFunction/SimpleFunctionVME.tst" target="_self">SimpleFunctionVME.tst</a></font>
    </p><p style="line-height: 100%; margin-top: 0; margin-bottom: 0"><font face="Courier New" size="2"><a href="http://www1.idc.ac.il/tecs/projects/08/FunctionCalls/SimpleFunction/SimpleFunction.tst" target="_self">SimpleFunction.tst</a></font><span style="font-size:12.0pt;mso-fareast-language:EN-US;layout-grid-mode:line">
    </span>
    </p><p style="line-height: 100%; margin-top: 0; margin-bottom: 0"><font face="Courier New" size="2"><a href="http://www1.idc.ac.il/tecs/projects/08/FunctionCalls/SimpleFunction/SimpleFunction.cmp" target="_self">SimpleFunction.</a></font><font face="Courier New" size="2"><a href="http://www1.idc.ac.il/tecs/projects/08/FunctionCalls/SimpleFunction/SimpleFunction.cmp" target="_self">cmp</a></font><a href="http://www1.idc.ac.il/tecs/projects/08/FunctionCalls/SimpleFunction/SimpleFunction.cmp" target="_self"><span style="font-size:12.0pt;mso-fareast-language:EN-US;layout-grid-mode:line">
    </span>
    </a>
    </p></td>
  </tr>
  <tr>
    <td width="99" valign="top" align="left" height="36">
    <p style="line-height: 100%; margin-top: 8; margin-bottom: 0"><span style="font-size: 12.0pt; font-family: Times New Roman; mso-fareast-font-family: Times New Roman; mso-ansi-language: EN-US; mso-fareast-language: HE; mso-bidi-language: HE; layout-grid-mode: line">FibonacciElement:</span>
    </p><p style="line-height: 100%; margin-top: 8; margin-bottom: 0"><a href="http://www1.idc.ac.il/tecs/projects/08/FunctionCalls/FibonacciElement/Main.vm"><font face="Courier New" size="2">Main.vm</font></a></p><p style="line-height: 100%; margin-top: 8; margin-bottom: 0"><a href="http://www1.idc.ac.il/tecs/projects/08/FunctionCalls/FibonacciElement/Sys.vm" target="_self"><font face="Courier New" size="2">Sys.vm</font></a>
    </p></td>
    <td width="643" valign="top" align="left" height="36">
    <p class="MsoBodyText" style="margin-top: 2; margin-bottom: 0" align="left"><span style="font-size:12.0pt;
mso-ascii-font-family:&quot;Times New Roman&quot;;mso-hansi-font-family:&quot;Times New Roman&quot;" class="code">A
    </span><span style="font-size:12.0pt">full test of the implementation of the
    VM's function calling commands, the bootstrap section and most of the other VM commands.</span>
    <span style="font-size:12.0pt">The
    program
    directory consists of two </span><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:&quot;Courier New&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;" class="code">.vm</span><span style="font-size:12.0pt">
    files:</span></p>
    <ul>
      <li>
        <p class="MsoBodyText" style="margin-top: 2; margin-bottom: 0" align="left"><span style="font-size: 10.0pt; font-family: Courier New; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: Times New Roman" class="code">Main.vm</span><span style="font-size: 12.0pt"><span style="font-size:12.0pt">
 </span><span style="font-size:12.0pt"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;;
mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-US;mso-fareast-language:
HE;mso-bidi-language:HE">contains one function called </span><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:
&quot;Courier New&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;mso-bidi-font-family:
&quot;Times New Roman&quot;;mso-ansi-language:EN-US;mso-fareast-language:HE;mso-bidi-language:
HE" class="code">fibonacci</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;;
mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-US;mso-fareast-language:
HE;mso-bidi-language:HE">. This recursive function returns the <i>n</i>�th element of
        the Fibonacci series;</span></span></span></p></li>
      <li>
        <p class="MsoBodyText" style="margin-top: 2; margin-bottom: 0" align="left"><span style="font-size: 10.0pt; font-family: Courier New; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: Times New Roman" class="code">S<span style="font-size: 10.0pt; font-family: Courier New; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: Times New Roman">y</span>s.vm</span><span style="font-size: 12.0pt"><span style="font-size:12.0pt">
        contains one function called </span></span><span style="font-size: 10.0pt; font-family: Courier New; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: Times New Roman" class="code">init</span><span style="font-size: 12.0pt"><span style="font-size:12.0pt">.&nbsp;
        This function calls the </span></span><span style="font-size: 10.0pt; font-family: Courier New; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: Times New Roman" class="code">Main.fibonacci</span><span style="font-size: 12.0pt">
        function with <i>n</i>=4, and then loops infinitely.<o:p>
        </o:p>
        </span></p></li>
    </ul>
    <p class="MsoBodyText" style="margin-top: 6.0pt" align="left"><span style="font-size: 12.0pt"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;;
mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-US;mso-fareast-language:
HE;mso-bidi-language:HE">(The bootstrap code of the VM implementation includes a
    call to </span><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:
&quot;Courier New&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;mso-bidi-font-family:
&quot;Times New Roman&quot;;mso-ansi-language:EN-US;mso-fareast-language:HE;mso-bidi-language:
HE" class="code">Sys.init</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;;
mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-US;mso-fareast-language:
HE;mso-bidi-language:HE">).</span> </span>
    </p>
    <p class="MsoBodyText" style="margin-top: 6.0pt" align="left"><span style="font-size: 12.0pt">Since
    the overall program consists of two </span>
    <span style="mso-bidi-font-size: 12.0pt; font-family: Courier New; mso-fareast-font-family: Times New Roman; mso-bidi-font-family: Times New Roman; mso-ansi-language: EN-US; mso-fareast-language: HE; mso-bidi-language: HE" class="code"> <font size="2"> .vm</font></span><span style="font-size: 12.0pt"> files, the entire directory
    must be compiled in order to produce a single </span>
    <span style="mso-bidi-font-size: 12.0pt; font-family: Courier New; mso-fareast-font-family: Times New Roman; mso-bidi-font-family: Times New Roman; mso-ansi-language: EN-US; mso-fareast-language: HE; mso-bidi-language: HE" class="code"><font size="2"> FibonacciElement.asm</font></span><span style="font-size: 12.0pt"> file. (compiling
    each </span>
    <span style="mso-bidi-font-size: 12.0pt; font-family: Courier New; mso-fareast-font-family: Times New Roman; mso-bidi-font-family: Times New Roman; mso-ansi-language: EN-US; mso-fareast-language: HE; mso-bidi-language: HE" class="code"><font size="2"> .vm</font></span>
    <span style="font-size: 12.0pt"> file separately will yield two separate </span>
    <span style="mso-bidi-font-size: 12.0pt; font-family: Courier New; mso-fareast-font-family: Times New Roman; mso-bidi-font-family: Times New Roman; mso-ansi-language: EN-US; mso-fareast-language: HE; mso-bidi-language: HE" class="code"><font size="2"> .asm</font></span>
    <span style="font-size: 12.0pt"> files, which is not
    desired here).</span>
    </p>
    </td>
    <td width="192" valign="top" align="left" height="36">
    <p style="line-height: 100%; margin-top: 0; margin-bottom: 0"><font face="Courier New" size="2"><a href="http://www1.idc.ac.il/tecs/projects/08/FunctionCalls/FibonacciElement/FibonacciElementVME.tst" target="_self">FibonacciElementVME.tst</a></font></p><p style="line-height: 100%; margin-top: 0; margin-bottom: 0"><span style="font-size:12.0pt;mso-fareast-language:EN-US;layout-grid-mode:line"></span><font face="Courier New" size="2"><a href="http://www1.idc.ac.il/tecs/projects/08/FunctionCalls/FibonacciElement/FibonacciElement.tst" target="_self">FibonacciElement.tst</a></font></p><p style="line-height: 100%; margin-top: 0; margin-bottom: 0"><font face="Courier New" size="2"><a href="http://www1.idc.ac.il/tecs/projects/08/FunctionCalls/FibonacciElement/FibonacciElement.cmp" target="_self">FibonacciElement.</a></font><font face="Courier New" size="2"><a href="http://www1.idc.ac.il/tecs/projects/08/FunctionCalls/FibonacciElement/FibonacciElement.cmp" target="_self">cmp</a></font>
    </p><p class="MsoBodyText" style="margin-top:6.0pt;text-align:justify"><span style="font-size:12.0pt">
    </span></p>
    <p style="line-height: 100%; margin-top: 8; margin-bottom: 0"><span style="font-size:12.0pt;mso-fareast-language:EN-US;layout-grid-mode:line">

    </span>
    </p></td>
  </tr>
  <tr>
    <td width="99" valign="top" align="left" height="36">
    <p style="line-height: 100%; margin-top: 2; margin-bottom: 0"><span style="font-size: 12.0pt; font-family: Times New Roman; mso-fareast-font-family: Times New Roman; mso-ansi-language: EN-US; mso-fareast-language: EN-US; mso-bidi-language: HE; layout-grid-mode: line">St</span><span style="font-size: 12.0pt; font-family: Times New Roman; mso-fareast-font-family: Times New Roman; mso-ansi-language: EN-US; mso-fareast-language: HE; mso-bidi-language: HE; layout-grid-mode: line">aticsTest:</span>
    </p><p style="line-height: 100%; margin-top: 2; margin-bottom: 0"><a href="http://www1.idc.ac.il/tecs/projects/08/FunctionCalls/StaticsTest/Class1.vm" target="_self"><font size="2" face="Courier New"><span style="mso-fareast-font-family: Times New Roman; mso-ansi-language: EN-US; mso-fareast-language: HE; mso-bidi-language: HE; layout-grid-mode: line">Class1.vm</span>
    </font></a>
    </p><p style="line-height: 100%; margin-top: 2; margin-bottom: 0"><a href="http://www1.idc.ac.il/tecs/projects/08/FunctionCalls/StaticsTest/Class2.vm" target="_self"><font size="2" face="Courier New"><span style="mso-fareast-font-family: Times New Roman; mso-ansi-language: EN-US; mso-fareast-language: HE; mso-bidi-language: HE; layout-grid-mode: line">Class2.vm</span>
    </font></a>
    </p><p style="line-height: 100%; margin-top: 2; margin-bottom: 0"><a href="http://www1.idc.ac.il/tecs/projects/08/FunctionCalls/StaticsTest/Sys.vm" target="_self"><font size="2" face="Courier New"><span style="mso-fareast-font-family: Times New Roman; mso-ansi-language: EN-US; mso-fareast-language: HE; mso-bidi-language: HE; layout-grid-mode: line">Sys.vm</span></font><span style="font-size: 12.0pt; font-family: Times New Roman; mso-fareast-font-family: Times New Roman; mso-ansi-language: EN-US; mso-fareast-language: HE; mso-bidi-language: HE; layout-grid-mode: line">&nbsp;</span>
    </a>
    </p></td>
    <td width="643" valign="top" align="left" height="36">
    <p style="line-height: 100%; margin-top: 0; margin-bottom: 0"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-ansi-language:EN-US;mso-fareast-language:HE;mso-bidi-language:HE" class="code">A
    full </span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;;mso-fareast-font-family:
&quot;Times New Roman&quot;;mso-ansi-language:EN-US;mso-fareast-language:HE;mso-bidi-language:
HE">test of the implementation's handling of static variables. Consists of two </span><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:&quot;Courier New&quot;;
mso-fareast-font-family:&quot;Times New Roman&quot;;mso-bidi-font-family:&quot;Times New Roman&quot;;
mso-ansi-language:EN-US;mso-fareast-language:HE;mso-bidi-language:HE" class="code">.vm</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;;mso-fareast-font-family:
&quot;Times New Roman&quot;;mso-ansi-language:EN-US;mso-fareast-language:HE;mso-bidi-language:
HE"> files, each representing the compilation of a stand-alone class file, plus a </span><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:
&quot;Courier New&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;mso-bidi-font-family:
&quot;Times New Roman&quot;;mso-ansi-language:EN-US;mso-fareast-language:HE;mso-bidi-language:
HE" class="code">Sys.vm</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;;
mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-US;mso-fareast-language:
HE;mso-bidi-language:HE"> file. The entire directory should be
    compiled in order to produce a single </span><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:&quot;Courier New&quot;;
mso-fareast-font-family:&quot;Times New Roman&quot;;mso-bidi-font-family:&quot;Times New Roman&quot;;
mso-ansi-language:EN-US;mso-fareast-language:HE;mso-bidi-language:HE" class="code">StaticsTest.asm</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;;mso-fareast-font-family:
&quot;Times New Roman&quot;;mso-ansi-language:EN-US;mso-fareast-language:HE;mso-bidi-language:
HE"> file.</span><span style="font-size:12.0pt;mso-fareast-language:EN-US;layout-grid-mode:line">
    </span>
    </p></td>
    <td width="192" valign="top" align="left" height="36">
    <p style="line-height: 100%; margin-top: 0; margin-bottom: 0"><font face="Courier New" size="2"><a href="http://www1.idc.ac.il/tecs/projects/08/FunctionCalls/StaticsTest/StaticsTestVME.tst" target="_self">StaticsTestVME.tst</a></font></p><p style="line-height: 100%; margin-top: 0; margin-bottom: 0"><font face="Courier New" size="2"><a href="http://www1.idc.ac.il/tecs/projects/08/FunctionCalls/StaticsTest/StaticsTest.tst" target="_self">StaticsTest.tst</a></font></p><p style="line-height: 100%; margin-top: 0; margin-bottom: 0"><font face="Courier New" size="2"><a href="http://www1.idc.ac.il/tecs/projects/08/FunctionCalls/StaticsTest/StaticsTest.cmp" target="_self">StaticsTest.cmp</a></font></p><p style="line-height: 100%; margin-top: 0; margin-bottom: 0">&nbsp;
    </p><p style="line-height: 100%; margin-top: 8; margin-bottom: 0"><span style="font-size:12.0pt;mso-fareast-language:EN-US;layout-grid-mode:line">
    </span>
    </p></td>
  </tr>
</tbody></table>

<p class="MsoBodyText" dir="LTR" style="text-align:justify;mso-outline-level:1"><strong><font color="#004080" face="Arial" size="3">Tips</font></strong></p>
<p class="MsoNormal" style="text-align:justify;direction:ltr;unicode-bidi:embed"><span style="mso-fareast-language: EN-US; layout-grid-mode: line"><span style="mso-fareast-language:EN-US;layout-grid-mode:
line">Start by creating a directory named </span><span style="font-size: 10.0pt; mso-bidi-font-size: 12.0pt; font-family: Courier New; mso-bidi-font-family: Times New Roman" class="code">projects/08</span>
<span style="mso-fareast-language:EN-US;layout-grid-mode:
line">on your computer and extracting <a href="http://www1.idc.ac.il/tecs/projects/08/project%2008.zip">project 08.zip</a>
to it (</span><span style="mso-fareast-language:EN-US;layout-grid-mode:
line">preserving the directory structure embedded in the zip file</span>).</span></p>
<p class="MsoNormal" style="text-align:justify;direction:ltr;unicode-bidi:embed"><b><span style="mso-fareast-language:EN-US;layout-grid-mode:line">Initialization:
</span></b><span style="mso-fareast-language:EN-US;layout-grid-mode:line">In
order </span>for any translated VM program to start running, it must include <span style="mso-fareast-language:
EN-US">a preamble startup code </span>that forces the VM implementation to start
executing it on the host platform. In addition, in order for any VM code to
operate properly, the VM implementation must store the base addresses of the
virtual segments in the correct locations in the host RAM.&nbsp; The first three
test programs in this project assume that the startup code was not yet
implemented, and include test scripts that effects the necessary initializations
"manually".&nbsp; The last two programs assume that the startup code
is already part of the VM implementation.</p>
<p class="MsoNormal" style="text-align:justify;direction:ltr;unicode-bidi:embed"><b><span style="font-size:12.0pt;mso-fareast-language:EN-US;layout-grid-mode:line">Testing/debugging:</span></b><span style="font-size:12.0pt;mso-fareast-language:EN-US"><span style="mso-spacerun:
yes">&nbsp; </span>For each one of the five test programs, follow these steps:<o:p>
</o:p>
</span></p>
<ol>
  <li>
    <p class="MsoNormal" style="margin-top:6.0pt;margin-right:2.8pt;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;text-align:justify;direction:ltr;
unicode-bidi:embed">Run the program on the supplied VM emulator, using the <span style="font-size: 10.0pt; mso-bidi-font-size: 12.0pt; font-family: Courier New; mso-bidi-font-family: Times New Roman" class="code">XxxVME.tst</span> test script, to get
    acquainted with the intended program's behavior.</p></li>
  <li>
    <p class="MsoNormal" style="margin-top:6.0pt;margin-right:2.8pt;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;text-align:justify;direction:ltr;
unicode-bidi:embed">Use your partial translator to translate the <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:
&quot;Courier New&quot;;mso-bidi-font-family:&quot;Times New Roman&quot;" class="code">.vm</span>
    file(s). The result should be a single text file containing a translated <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:
&quot;Courier New&quot;;mso-bidi-font-family:&quot;Times New Roman&quot;" class="code">.asm</span>
    program, written in the Hack assembly language.</p></li>
  <li>
    <p class="MsoNormal" style="margin-top:6.0pt;margin-right:2.8pt;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;text-align:justify;direction:ltr;
unicode-bidi:embed">Inspect the translated <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:&quot;Courier New&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;" class="code">.asm</span>
    program. If there are visible syntax (or any other) errors, debug and fix
    your translator.</p></li>
  <li>
    <p class="MsoNormal" style="margin-top:6.0pt;margin-right:2.8pt;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;text-align:justify;direction:ltr;
unicode-bidi:embed">Use the supplied <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:&quot;Courier New&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;" class="code">.tst</span> and <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:
&quot;Courier New&quot;;mso-bidi-font-family:&quot;Times New Roman&quot;" class="code">.cmp</span>
    files to run your translated <span style="font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:&quot;Courier New&quot;;mso-bidi-font-family:&quot;Times New Roman&quot;" class="code">.asm</span>
    program on the CPU emulator. If there are run-time errors, debug and fix
    your translator.</p></li>
</ol>
    <p class="MsoNormal" style="margin-top:6.0pt;margin-right:2.8pt;margin-bottom:
0cm;margin-left:0cm;margin-bottom:.0001pt;text-align:justify;direction:ltr;
unicode-bidi:embed"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;;mso-fareast-font-family:
&quot;Times New Roman&quot;;mso-ansi-language:EN-US;mso-fareast-language:HE;mso-bidi-language:
HE">Note: T</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;;
mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-US;mso-fareast-language:
EN-US;mso-bidi-language:HE">he supplied test programs were carefully planned to
    test the specific features of each stage in your VM implementation.
    Therefore, it�s important to implement your translator in the proposed
    order, and to test it using the appropriate test programs at each stage.
    Implementing a later stage before an early one may cause the test programs
    to fail.</span>
</p><p class="MsoBodyText" dir="LTR" style="text-align:justify;mso-outline-level:1"><strong><font color="#004080" face="Arial" size="3">Tools</font></strong>
<span style="font-size: 12.0pt; mso-fareast-language: EN-US; layout-grid-mode: line">(same
as in Project 7)</span></p>
<p class="MsoBodyText" dir="LTR" style="text-align:justify;mso-outline-level:1"><span style="font-size: 12.0pt; mso-fareast-language: EN-US; layout-grid-mode: line"><b>The
VM emulator:</b>  The book's software includes a Java-based VM implementation. <span style="font-size:12.0pt">This&nbsp;VM emulator was built for one purpose: illustrating how the VM works, using visual GUI and
animation effects. Specifically, it allows executing VM programs directly,
without having to translate them first into machine language. This practice
enables experimentation with the VM environment before you set out to implement
one yourself.</span><span style="font-size:12.0pt;mso-fareast-language:EN-US;
layout-grid-mode:line">&nbsp; Here is a typical screen shot of the VM emulator in
action:</span></span></p>
<p class="MsoBodyText" dir="LTR" style="text-align:justify;mso-outline-level:1"><img border="0" src="./fig 7.15.gif" width="880" height="636"><span style="font-size: 12.0pt; mso-fareast-language: EN-US; layout-grid-mode: line"><o:p>
</o:p>
</span></p>
<p class="MsoBodyText" dir="LTR" style="text-align:justify;mso-outline-level:1">&nbsp;</p>


</body></html>
